/**
 * Create a new blank binary workbook (XLSB).
 * @module createBinaryWorkbook
 * @category Operations
 */

import type { DriveItem } from "@microsoft/microsoft-graph-types";
import InvalidArgumentError from "../../errors/InvalidArgumentError.ts";
import type { DriveRef } from "../../models/Drive.ts";
import type { DriveItemId, DriveItemPath, DriveItemRef } from "../../models/DriveItem.ts";
import type { GraphOperation } from "../../models/GraphOperation.ts";
import type { WorkbookRef } from "../../models/Workbook.ts";
import { binaryWorkbookFileExtension, createDriveItemRef, workbookFileExtension } from "../../services/driveItem.ts";
import { operation } from "../../services/operationInvoker.ts";
import { generatePath } from "../../services/templatedPaths.ts";

const blankFile =
	"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";

/**
 * Create a new blank binary workbook (XLSB).
 * @param parentRef Reference to the parent drive or folder where the workbook will be created.
 * @param itemPath Path (including the filename) for the new workbook.
 * @returns Newly created workbook.
 * @throws {@link InvalidArgumentError} if the item path does not end with `.xlsb`.
 * @see https://learn.microsoft.com/en-us/graph/api/driveitem-put-content
 */
export default function createBinaryWorkbook(parentRef: DriveRef | DriveItemRef, itemPath: DriveItemPath): GraphOperation<DriveItem & WorkbookRef> {
	if (!itemPath.endsWith(`.${binaryWorkbookFileExtension}`)) {
		throw new InvalidArgumentError(`Item path must end with '.${workbookFileExtension}'`);
	}
	const pathSegment = (parentRef as DriveItemRef).itemId ? "items/{item-id}" : "root";

	return operation({
		context: parentRef.context,
		method: "PUT",
		path: generatePath(`/sites/{site-id}/drives/{drive-id}/${pathSegment}:/${itemPath}:/content`, parentRef),
		headers: {
			"content-type": "application/vnd.ms-excel.sheet.binary",
		},
		body: Buffer.from(blankFile, "base64"),
		responseTransform: (response) => {
			const driveItem = response as DriveItem;

			const itemRef = createDriveItemRef(parentRef, driveItem.id as DriveItemId);

			return {
				...driveItem,
				...itemRef,
			};
		},
	});
}
